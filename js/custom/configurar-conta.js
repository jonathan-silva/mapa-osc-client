"use strict";function replaceSpecialChars(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[ÀÁÂÃÄÅ]/g,"A")).replace(/[àáâãäå]/g,"a")).replace(/[ÉÈÊË]/g,"E")).replace(/[éèêë]/g,"e")).replace(/[ÍÌÎÏ]/g,"I")).replace(/[íìîï]/g,"i")).replace(/[ÓÒÔÕ]/g,"O")).replace(/[óòôõ]/g,"o")).replace(/[ÚÙÛÜ]/g,"U")).replace(/[úùûü]/g,"u")).replace(/[Ç]/g,"C")).replace(/[ç]/g,"c")}function validaEmail(e){var a=e.substring(0,e.indexOf("@")),o=e.substring(e.indexOf("@")+1,e.length);return 1<=a.length&&3<=o.length&&-1==a.search("@")&&-1==o.search("@")&&-1==a.search(" ")&&-1==o.search(" ")&&-1!=o.search(".")&&1<=o.indexOf(".")&&o.lastIndexOf(".")<o.length-1}require(["jquery-ui"],function(e){$(document).tooltip({position:{my:"center bottom-20",at:"center top",using:function(e,a){$(this).css(e),$("<div>").addClass("arrow").addClass(a.vertical).addClass(a.horizontal).appendTo(this)}}}),jQuery(document).ready(function(a){a(".scroll").click(function(e){e.preventDefault(),a("html,body").animate({scrollTop:a(this.hash).offset().top},800)})})}),require(["react","jsx!components/Util","jquery-ui","rotas","tagsinput"],function(g){require(["componenteFormItem"],function(e){function a(e,a,o,s){this.id=e,this.label=a,this.type=o,this.obrigatorio=s,this.fonte=!1}for(var o=["nome","email","senha","confirmarSenha"],s=["Nome","Email","Senha","Confirmar Senha"],r=["text","email","password","password"],t=[!0,!0,!1,!1],n=[],l=0;l<o.length;l++)n.push(new a(o[l],s[l],r[l],t[l]));for(var c=["nomeEntidade"],i=["CNPJ da Entidade"],d=["text"],u=[!0],m=[],p=0;p<c.length;p++)m.push(new a(c[p],i[p],d[p],u[p]));e=g.createFactory(e),ReactDOM.render(e({header:"Dados de Identificação.",dados:n}),document.getElementById("form-dados")),ReactDOM.render(e({header:"Suas Organizações.",dados:m}),document.getElementById("form-org"))});var i=window.localStorage.getItem("User"),e=window.localStorage.getItem("Authorization"),a={User:i,Authorization:e},d={};d.headers=a;var u=new Rotas;$("#tag").tagsinput({cancelConfirmKeysOnEmpty:!1,freeInput:!1,itemValue:"id",itemText:"text"}),$.ajax({url:u.ValidarUsuario(i),type:"GET",dataType:"json",success:function(e){$("#nome").val(e.tx_nome_usuario),$("#email").val(e.tx_email_usuario);for(var a=0;a<e.representacao.length;a++)0==a&&$("#tags").prepend('<label class="control-label listaOscs">Lista de OSCs: <span class="obrigatorio glyphicon-asterisk">(Campo Obrigatório)</span></label>'),$("#tags").removeClass("hide"),$("#tag").tagsinput("add",{id:e.representacao[a].id_osc,text:e.representacao[a].tx_nome_osc});$("#tags span[data-role=remove]").each(function(){$(this).addClass("tagRemove").prop("title","Clique para Remover a OSC do seu Cadastro.")})},error:function(e){console.log(e),$("#modalMensagem").modal({backdrop:"static",keyboard:!1}),$("#modalTitle").text("Erro"),$("#modalConteudo").text("É necessário estar logado no sistema para acessar essa página."),$(".modal-footer button").on("click",function(){history.go(-1)}),$("#modalMensagem").modal("show")}}),require(["jquery-ui","rotas"],function(e){$("#nomeEntidade.form-control").autocomplete({minLength:14,source:function(e,a){$.ajax({url:u.AutocompleteOSCByCnpj(replaceSpecialChars(e.term).replace(/ /g,"+"),10),type:"GET",dataType:"json",success:function(e){null===e?$("#nomeEntidade.form-control").closest(".form-group").removeClass("has-success").addClass("has-error"):$("#nomeEntidade.form-control").closest(".form-group").removeClass("has-error").addClass("has-success"),a($.map(e,function(e){return{label:e.tx_nome_osc,value:e.tx_nome_osc,id:e.id_osc}}))},error:function(e){a([])}})},select:function(e,a){a.item.id,$("#tags").removeClass("hide"),$("#tag").tagsinput("add",{id:a.item.id,text:a.item.label}),$("#tags span[data-role=remove]").each(function(){$(this).addClass("tagRemove").prop("title","Clique para Remover a OSC do seu Cadastro.")})}})}),$("#send").on("click",function(){var e=$("#nome").val(),a=$("#email").val().toLowerCase(),o=$("#senha").val(),s=$("#confirmarSenha").val(),r=$("#tag").val(),t=!0;if(""===e||null===e?($("#nome").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#nome").closest(".form-group").append('<div class="form-group row-centered"><span id="labelError" class="label label-danger centered">Erro: Nome não pode está vazio!</span></div>')):($("#nome").closest(".form-group").removeClass("has-error").addClass("has-success"),t=!1),t=validaEmail(a)?($("#email").closest(".form-group").removeClass("has-error").addClass("has-success"),!!t):($("#email").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#email").closest(".form-group").append('<div class="form-group row-centered"><span id="labelError" class="label label-danger centered">Erro: Email não pode está vazio!</span></div>'),!0),""!==o&&(5<o.length?t=s===o?($("#senha").closest(".form-group").removeClass("has-error").addClass("has-success"),$("#confirmarSenha").closest(".form-group").removeClass("has-error").addClass("has-success"),!!t):($("#senha").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#confirmarSenha").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#confirmarSenha").closest(".form-group").append('<div class="form-group row-centered"><span id="labelError" class="label label-danger centered">Erro: Confirmar senha tem que ser igual senha!</span></div>'),!0):(t=!0,$("#senha").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#confirmarSenha").closest(".form-group").removeClass("has-success").addClass("has-error"),$("#senha").closest(".form-group").append('<div class="form-group row-centered"><span id="labelError" class="label label-danger centered">Erro: Senha é Menor que 6 Caracteres!</span></div>'))),!(t=""===r||null===r?($("#tag").closest("#tags").append('<div class="form-group row-centered"><span id="labelError" class="label label-danger centered">Erro: É necessário ter pelo menos uma OSC!</span></div>'),!0):!!t)){d.tx_nome_usuario=e,d.tx_email_usuario=a,""!==o&&null!==o&&5<o.length&&(d.tx_senha_usuario=o);for(var n=r.split(","),l=[],c=0;c<n.length;c++)l.push({id_osc:n[c]});d.representacao=l,d.id_usuario=i,$.ajax({url:u.UpdateUsuario(i),type:"POST",dataType:"json",data:d,success:function(e){$("#modalTitle").text("Sucesso"),$("#modalConteudo").text("Sua atualização foi realizada com sucesso."),$("#modalMensagem").modal("show"),window.localStorage.setItem("Authorization",e.access_token),window.localStorage.setItem("Osc",e.representacao),window.localStorage.setItem("Nome",e.tx_nome_usuario),$(".menuLogado .dropdown-toggle").html(""),$(".menuLogado .dropdown-toggle").append(e.tx_nome_usuario),$(".menuLogado .dropdown-toggle").append(' <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>')},error:function(e){console.log(e)}})}})});