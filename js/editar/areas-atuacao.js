"use strict";var _createClass=function(){function o(a,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}return function(a,e,t){return e&&o(a.prototype,e),t&&o(a,t),a}}();function _classCallCheck(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}var AreaAtuacao=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"AutocompleteItem",value:function(a,e,t,o,r,s,u,n,c,_){return{id:a,label:e,content:t,fonte:o,placeholder:r,type:s,custom_class:u,areas:n,subareas:c,subareas_selected:_}}},{key:"loadSuggestions",value:function(a,e,t,o,r,s){for(var u=a[0],n=a[1],c=0;c<n.length;c++)n[c].label=n[c].tx_nome_subarea_atuacao,n[c].value=n[c].cd_subarea_atuacao;var _=[],i=o.areasAtuacao().form_items;_.push(this.AutocompleteItem(i[0].id,i[0].label,t.validateObject(r,"Não informado"),t.validateObject(s,"Não informado"),i[0].placeholder,i[0].type,i[0].custom_class,u,n)),i.splice(0,1);for(var l=0;l<i.length;l++){if(0!==t.validateObject(e,0)){if("macro_area_1"===i[l].id&&(i[l].content=e?e[0].tx_nome_area_atuacao:"",i[l].subareas_selected=e?e[0].subarea_atuacao:"",i[l].fonte=e?e[0].ft_area_atuacao:null),"macro_area_2"===i[l].id&&(i[l].content=1<e.length?e[1].tx_nome_area_atuacao:"",i[l].subareas_selected=1<e.length?e[1].subarea_atuacao:null,i[l].fonte=1<e.length?e[1].ft_area_atuacao:null),t.validateObject(e[0],!1))if("Outros"===e[0].tx_nome_area_atuacao){if("macro_area_1_outros"===i[l].id&&(i[l].content=e[0].tx_nome_area_atuacao_outra?e[0].tx_nome_area_atuacao_outra:""),"sub_area_1_outros"===i[l].id){var d=e[0].subarea_atuacao?e[0].subarea_atuacao.length:0;for(c=0;c<d;c++)null!==e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"",console.log(i[l].content))}}else if("macro_area_1_outros"===i[l].id&&(i[l].content=e[0].tx_nome_area_atuacao_outra?e[0].tx_nome_area_atuacao_outra:""),"sub_area_1_outros"===i[l].id)for(d=e[0].subarea_atuacao?e[0].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"");if(t.validateObject(e[1],!1))if("Outros"===e[1].tx_nome_area_atuacao){if("macro_area_2_outros"===i[l].id&&(i[l].content=e[1].tx_nome_area_atuacao_outra?e[1].tx_nome_area_atuacao_outra:""),"sub_area_2_outros"===i[l].id)for(d=e[1].subarea_atuacao?e[1].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"")}else if("macro_area_2_outros"===i[l].id&&(i[l].content=e[1].subarea_atuacao?e[1].tx_nome_area_atuacao_outra:""),"sub_area_2_outros"===i[l].id)for(d=e[1].subarea_atuacao?e[1].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"")}"autocomplete"===i[l].custom_class?_.push(this.AutocompleteItem(i[l].id,i[l].label,i[l].content,i[l].fonte,i[l].placeholder,i[l].type,i[l].custom_class,u,n,i[l].subareas_selected)):_.push(t.FormItens(i[l].id,i[l].label,i[l].content,i[l].fonte,i[l].placeholder,i[l].type,i[l].options,i[l].pretext,i[l].custom_class,i[l].hide))}return{formItens:_,area_suggestions:a,macro_area_suggestions:u=$.map(u,function(a){return{label:a.tx_nome_area_atuacao,value:a.tx_nome_area_atuacao,id:a.cd_area_atuacao}})}}},{key:"carregaMacro",value:function(e,t){return $.ajax({url:e.AreaAtuacao(),async:!1,type:"GET",dataType:"json",success:function(a){t.push(a),$.ajax({url:e.SubAreaAtuacao(),async:!1,type:"GET",dataType:"json",success:function(a){t.push(a)},error:function(a){console.log(a)}})},error:function(a){console.log(a)}}),t}},{key:"montarAreasDeAtuacao",value:function(a,e,t,o,r,s,u,n,c){var _=e.validateObject(a.area_atuacao,[]),i=e.validateObject(_.area_atuacao_outra,[]);_=[].concat(_).concat(i);var l=this.carregaMacro(o,[],e),d=e.validateObject(_[0],[]),h=this.loadSuggestions(l,d.area_atuacao,e,t,r,s),f=h.formItens;return c=u.createFactory(c),n.render(c({header:{priority:"2",text:"Áreas e Subáreas de Atuação da OSC"},dados:f}),document.getElementById("areas_de_atuacao")),this.carregarAreasAtuacao(h.area_suggestions,h.macro_area_suggestions),l}},{key:"carregarAreasAtuacao",value:function(a,_){var i=0;$("#areas_de_atuacao .autocomplete").autocomplete({minLength:0,create:function(a,e){for(var t=$(this).attr("placeholder"),o=0;o<_.length;o++){if(_[o].value===t){var r=$(this).siblings(".checkboxList").find("#subareas-"+o);r.hasClass("hidden")&&r.toggleClass("hidden");for(var s=0;s<_.length;s++)if(t===_[s].tx_nome_area_atuacao){var u=!1;r.find("label").each(function(){_[s].tx_nome_subarea_atuacao===$(this).text().trim()&&(u=$(this))}),u?u.find("input").prop("checked",!0):r.find("#outros").val(_[s].tx_nome_subarea_atuacao)}}}},source:_,change:function(a,e){},select:function(a,e){"macro_area_1"==a.target.id?($("#sub_area_1_outros").parent().parent().addClass("hidden"),$("#sub_area_1_outros").val("")):($("#sub_area_2_outros").parent().parent().addClass("hidden"),$("#sub_area_2_outros").val("")),$(this).parent().find(":checkbox").prop("checked",!1);var t=a.target,o=_.indexOf(e.item)+1;i=o;var r=$($(t).siblings(".checkboxList")[0]);r.children().each(function(a){$(this).hasClass("hidden")||($(this).toggleClass("hidden"),$(this).children().each(function(a){var e=$($(this).find("input")[0]);e.is(":checked")&&e.prop("checked",!1),"text"==e.prop("type")&&e.val("")}))});var s=r.find("#subareas-"+o);s.hasClass("hidden")&&s.toggleClass("hidden");var u=e.item.value,n=$(this).closest(".form-group"),c=null;(c="macro_area_1"===(o=n.find(".autocomplete").attr("id"))?n.siblings().find("#macro_area_1_outros").closest(".form-group"):n.siblings().find("#macro_area_2_outros").closest(".form-group"),"Outros"===u)?(c.toggleClass("hidden"),c.hasClass("hidden")&&c.find("input").val("")):c.hasClass("hidden")||(c.toggleClass("hidden"),c.find("input").val(""))}}),$(".autocomplete").on("click",function(){$(this).autocomplete("search","")}),$(".autocomplete").keyup(function(){if(""===$(this).val()&&0!=i){var a=i,e=$(this).parent().find("#subareas-"+a);e.hasClass("hidden")||e.toggleClass("hidden")}}),$(".autocomplete").focusout(function(a){var e=this.value.toLowerCase(),t=!1,o=this.id,r=o.split("macro_area_");$("#ui-id-"+r[1]+" .ui-menu-item-wrapper").each(function(){if($(this).text().toLowerCase()===e)return!(t=!0)}),t||($("#"+o).val(""),$("#"+o).parent().find(".checkboxList div[id^='subareas-']:not(:hidden)").each(function(){$(this).toggleClass("hidden")}))}),$(".checkboxList :checkbox").change(function(){if("Outros"===$(this).closest("label").text()){var a=$(this).closest(".form-group"),e=null;if((e="macro_area_1"===a.find(".autocomplete").attr("id")?a.siblings().find("#sub_area_1_outros").closest(".form-group"):a.siblings().find("#sub_area_2_outros").closest(".form-group")).toggleClass("hidden"),e.hasClass("hidden"))e.find("input").val("")}}),$(".checkboxList").each(function(){$(this).find("input").each(function(){if($(this).is(":checked")&&"Outros"===$(this).closest("label").text()){var a=$(this).closest(".form-group"),e=null;if((e="macro_area_1"===a.find(".autocomplete").attr("id")?a.siblings().find("#sub_area_1_outros").closest(".form-group"):a.siblings().find("#sub_area_2_outros").closest(".form-group")).toggleClass("hidden"),e.hasClass("hidden"))e.find("input").val("")}})});var e=$("#macro_area_1"),t=$("#macro_area_2");"Outros"==e.val()&&$("#macro_area_1_outros").parent().parent().removeClass("hidden"),"Outros"==t.val()&&$("#macro_area_2_outros").parent().parent().removeClass("hidden")}}]),a}();